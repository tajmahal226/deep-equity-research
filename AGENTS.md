# Repository Guidelines

## Project Structure & Module Organization
- `src/` contains the Next.js app, feature components, Zustand stores, and shared utilities (e.g., `src/utils/deep-research`, `src/components/ResearchModes`).
- `public/` hosts static assets delivered verbatim.
- `tests/` mirrors the source layout (`tests/utils`, `tests/api`, `tests/integration`) and holds Vitest specs; root-level `test-*.js` scripts exercise longer research flows.
- Root configs (`next.config.ts`, `vitest.config.mts`, `eslint.config.mjs`, `tailwind.config.ts`) sit alongside this file; reference docs live in `docs/`.

## Build, Test, and Development Commands
- `pnpm dev` — run the Turbopack dev server at `http://localhost:3000`.
- `pnpm build` — produce the production bundle; required before `pnpm start`, Docker, or exports.
- `pnpm start` — serve the optimized build generated by `pnpm build`.
- `pnpm lint` — execute ESLint with project rules; fix issues or add targeted directives.
- `pnpm test` — run the Vitest suite; use `pnpm vitest run path/to/file.test.ts` for focused checks.

## Coding Style & Naming Conventions
- TypeScript uses strict mode with 2-space indentation; prefer modern ES module syntax and `async/await`.
- Naming: camelCase for variables/functions, PascalCase for React components, kebab-case for feature files, SCREAMING_SNAKE_CASE for constants.
- Tailwind utility classes drive styling; shared tokens live in `src/styles` and `tailwind.config.ts`.
- Run Prettier via your editor, then `pnpm lint` to validate formatting.

## Testing Guidelines
- Vitest is the default harness; co-locate tests under `tests/<domain>/` and mirror source structure.
- Name files `*.test.ts`; reset mocks with `vi.resetModules()` when stubbing providers.
- Integration suites stream AI output (see `tests/integration`); mock provider keys as needed.
- Confirm `pnpm test` before PRs and add new cases for features or bug fixes.

## Commit & Pull Request Guidelines
- Use Conventional Commits where possible (`feat:`, `fix:`, `chore:`) and keep changes scoped and reversible.
- Include relevant tests, docs, and lint fixes in the same commit.
- PRs should summarize the problem, solution, and verification; link issues, add screenshots for UI updates, and note env or migration impacts.
- Ensure CI parity by running `pnpm lint` and `pnpm test` locally.

## Security & Configuration Tips
- Never commit real API keys. Copy `.env.example` to `.env.local`, populate provider credentials (OpenAI, Tavily, Anthropic, DeepSeek, xAI, etc.), and document new vars in `.env.example` + `README.md`.
- Middleware (`src/middleware.ts`) enforces API key routing and disabled providers—update it when introducing new endpoints.
- When adding third-party services, review rate limits and log usage guidance in `docs/`.

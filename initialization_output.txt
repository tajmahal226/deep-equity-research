
> tj-deep-research@0.0.1 test
> vitest run tests/integration/initialization.test.ts


[1m[46m RUN [49m[22m [36mv3.2.4 [39m[90mC:/Users/tyler/projects/deep-equity-research[39m

[90mstdout[2m | tests/integration/initialization.test.ts[2m > [22m[2mCompany Research Initialization Integration Test[2m > [22m[2mhandles missing API keys gracefully
[22m[39mCompanyDeepResearch constructor - Checking imports:
systemInstruction: string You are a public equity investment analyst with de...
outputGuidelinesPrompt: string <OutputGuidelines>

## Typographical rules

Follow...
INVESTMENT_RESEARCH_SECTIONS: object [
  [32m'companyOverview'[39m,
  [32m'companyProductDeepDive'[39m,
  [32m'customersBuyersChannels'[39m,
  [32m'marketBackground'[39m,
  [32m'competitiveAnalysis'[39m,
  [32m'trendsAndStrategy'[39m,
  [32m'bullBearCase'[39m,
  [32m'keyQuestions'[39m,
  [32m'recentNews'[39m
]

[90mstdout[2m | tests/integration/initialization.test.ts[2m > [22m[2mCompany Research Initialization Integration Test[2m > [22m[2mprovides helpful error messages for different providers
[22m[39mCompanyDeepResearch constructor - Checking imports:
systemInstruction: string You are a public equity investment analyst with de...
outputGuidelinesPrompt: string <OutputGuidelines>

## Typographical rules

Follow...
INVESTMENT_RESEARCH_SECTIONS: object [
  [32m'companyOverview'[39m,
  [32m'companyProductDeepDive'[39m,
  [32m'customersBuyersChannels'[39m,
  [32m'marketBackground'[39m,
  [32m'competitiveAnalysis'[39m,
  [32m'trendsAndStrategy'[39m,
  [32m'bullBearCase'[39m,
  [32m'keyQuestions'[39m,
  [32m'recentNews'[39m
]

[90mstdout[2m | tests/integration/initialization.test.ts[2m > [22m[2mCompany Research Initialization Integration Test[2m > [22m[2mprovides helpful error messages for different providers
[22m[39mCompanyDeepResearch constructor - Checking imports:
systemInstruction: string You are a public equity investment analyst with de...
outputGuidelinesPrompt: string <OutputGuidelines>

## Typographical rules

Follow...
INVESTMENT_RESEARCH_SECTIONS: object [
  [32m'companyOverview'[39m,
  [32m'companyProductDeepDive'[39m,
  [32m'customersBuyersChannels'[39m,
  [32m'marketBackground'[39m,
  [32m'competitiveAnalysis'[39m,
  [32m'trendsAndStrategy'[39m,
  [32m'bullBearCase'[39m,
  [32m'keyQuestions'[39m,
  [32m'recentNews'[39m
]

[90mstdout[2m | tests/integration/initialization.test.ts[2m > [22m[2mCompany Research Initialization Integration Test[2m > [22m[2mprovides helpful error messages for different providers
[22m[39mCompanyDeepResearch constructor - Checking imports:
systemInstruction: string You are a public equity investment analyst with de...
outputGuidelinesPrompt: string <OutputGuidelines>

## Typographical rules

Follow...
INVESTMENT_RESEARCH_SECTIONS: object [
  [32m'companyOverview'[39m,
  [32m'companyProductDeepDive'[39m,
  [32m'customersBuyersChannels'[39m,
  [32m'marketBackground'[39m,
  [32m'competitiveAnalysis'[39m,
  [32m'trendsAndStrategy'[39m,
  [32m'bullBearCase'[39m,
  [32m'keyQuestions'[39m,
  [32m'recentNews'[39m
]

[90mstdout[2m | tests/integration/initialization.test.ts[2m > [22m[2mCompany Research Initialization Integration Test[2m > [22m[2mprovides helpful error messages for different providers
[22m[39mCompanyDeepResearch constructor - Checking imports:
systemInstruction: string You are a public equity investment analyst with de...
outputGuidelinesPrompt: string <OutputGuidelines>

## Typographical rules

Follow...
INVESTMENT_RESEARCH_SECTIONS: object [
  [32m'companyOverview'[39m,
  [32m'companyProductDeepDive'[39m,
  [32m'customersBuyersChannels'[39m,
  [32m'marketBackground'[39m,
  [32m'competitiveAnalysis'[39m,
  [32m'trendsAndStrategy'[39m,
  [32m'bullBearCase'[39m,
  [32m'keyQuestions'[39m,
  [32m'recentNews'[39m
]
[createAIProvider] Creating provider: google, model: test-model
[createProvider] Factory called for: google

[90mstdout[2m | tests/integration/initialization.test.ts[2m > [22m[2mCompany Research Initialization Integration Test[2m > [22m[2mprovides helpful error messages for different providers
[22m[39m[createAIProvider] Creating provider: google, model: test-model
[createProvider] Factory called for: google

[90mstdout[2m | tests/integration/initialization.test.ts[2m > [22m[2mCompany Research Initialization Integration Test[2m > [22m[2mworks when API keys are provided
[22m[39mCompanyDeepResearch constructor - Checking imports:
systemInstruction: string You are a public equity investment analyst with de...
outputGuidelinesPrompt: string <OutputGuidelines>

## Typographical rules

Follow...
INVESTMENT_RESEARCH_SECTIONS: object [
  [32m'companyOverview'[39m,
  [32m'companyProductDeepDive'[39m,
  [32m'customersBuyersChannels'[39m,
  [32m'marketBackground'[39m,
  [32m'competitiveAnalysis'[39m,
  [32m'trendsAndStrategy'[39m,
  [32m'bullBearCase'[39m,
  [32m'keyQuestions'[39m,
  [32m'recentNews'[39m
]
[createAIProvider] Creating provider: openai, model: gpt-4o
[createProvider] Factory called for: openai

[90mstdout[2m | tests/integration/initialization.test.ts[2m > [22m[2mCompany Research Initialization Integration Test[2m > [22m[2mworks when API keys are provided
[22m[39m[createAIProvider] Creating provider: openai, model: gpt-4o
[createProvider] Factory called for: openai

 [31mÎ“Â¥Â»[39m tests/integration/initialization.test.ts [2m([22m[2m3 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[32m 13[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Company Research Initialization Integration Test[2m > [22mhandles missing API keys gracefully[32m 4[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Company Research Initialization Integration Test[2m > [22mprovides helpful error messages for different providers[39m[32m 5[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 'Cannot read properties of undefined (Î“Ã‡Âª' to match /No API key found for google/i[39m
   [32mÎ“Â£Ã´[39m Company Research Initialization Integration Test[2m > [22mworks when API keys are provided[32m 1[2mms[22m[39m

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â» Failed Tests 1 Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»

 FAIL  tests/integration/initialization.test.ts > Company Research Initialization Integration Test > provides helpful error messages for different providers
AssertionError: expected 'Cannot read properties of undefined (Î“Ã‡Âª' to match /No API key found for google/i

- Expected: 
/No API key found for google/i

+ Received: 
"Cannot read properties of undefined (reading 'length')"

 Î“Â¥Â» tests/integration/initialization.test.ts:112:31
    110|         expect.fail(`Should have thrown error for ${testCase.provider}Î“Ã‡Âª
    111|       } catch (error) {
    112|         expect(error.message).toMatch(testCase.expectedMessage);
       |                               ^
    113|         expect(error.message).toMatch(/settings gear icon/i);
    114|       }

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[1/1]Î“Ã„Â»


[2m Test Files [22m [1m[31m1 failed[39m[22m[90m (1)[39m
[2m      Tests [22m [1m[31m1 failed[39m[22m[2m | [22m[1m[32m2 passed[39m[22m[90m (3)[39m
[2m   Start at [22m 17:21:08
[2m   Duration [22m 1.02s[2m (transform 176ms, setup 23ms, collect 380ms, tests 13ms, environment 0ms, prepare 169ms)[22m

